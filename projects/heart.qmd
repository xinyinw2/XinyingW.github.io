---
title: "Heart Attack Prediction"
date: 2025-03-19
image: p_images/heart.jpg
categories: [R, Tableau, Classification]
description: "Predicts elevated heart-attack risk using machine learning and explains key drivers to support prevention and clinical decisions."
page-layout: article
page-navigation: true
---

# Overview

This project develops a predictive model to flag individuals at **elevated risk of heart attack**, combining machine learning with interpretable analytics so results are useful for **screening, prevention, and clinical decision support**. We focus on identifying which **clinical, lifestyle, and demographic factors** most influence risk, and on calibrating the model’s **precision and recall** to be reliable for real-world use.

**Why this matters**

- Heart disease is a leading cause of death worldwide (18M+ deaths annually).  
- In the U.S., someone has a heart attack every ~40 seconds, and over 50% report no prior symptoms.  
- The economic burden exceeds \$200B annually.

**Who benefits**

- **Patients:** personalized risk scores and driver explanations to guide lifestyle changes, medication adherence, and timely medical follow-up.  
- **Clinicians:** an evidence-based complement to clinical judgment that helps prioritize care and manage panels efficiently.  
- **Policymakers & health systems:** population-level insights to target prevention programs and reduce cardiovascular burden.

**Research questions**

- Which factors most strongly influence heart-attack risk in our data?  
- What **precision/recall** balance makes the model dependable for screening and referral?  
- How can insights translate into **preventive actions** for patients (e.g., lifestyle changes, adherence)?

# Problem statement

Cardiovascular disease is a leading cause of death, and many heart attacks occur without prior symptoms. Screening resources are limited, and risk is often underestimated until it is too late. Patients need clear, interpretable feedback they can act on, and clinicians need a reliable way to identify elevated risk earlier and prioritize preventive care. The core problem is to build a model that estimates individual heart-attack risk from routinely available data and explains why a person is high risk in time to intervene.

Our objectives are to predict near-term heart-attack risk at the individual level, explain the top risk drivers in language patients and clinicians understand, and calibrate precision and recall so the model is safe for screening (high recall) and practical for follow-up (adequate precision). The scope includes clinical, lifestyle, and demographic inputs commonly captured in care or surveys, and concise contributing factors. We must handle class imbalance and missing data while maintaining interpretability and fairness across subgroups.

Success will be defined by meeting agreed performance thresholds (e.g., strong AUROC and PR-AUC) and an operational precision/recall target set with clinical stakeholders. We will also look for stable performance across age and sex subgroups, documented bias checks, and explanation quality that clinicians rate as useful for counseling and care planning.


# Data

The dataset comes from a dataset named "Heart Attack Risk Prediction Dataset" from Kaggle. This dataset is designed to analyze and predict heart attack risk based on various health, lifestyle, and demographic factors. It includes attributes such as age, cholesterol levels, blood pressure, smoking habits, exercise patterns, dietary preferences, and medical history. By leveraging predictive analytics and machine learning, this dataset can aid researchers and healthcare professionals in developing proactive strategies for heart disease prevention and management.
.

### Snapshot

* Rows: 8,763 

* Columns: 26

* Target variable: Heart_Attack_Risk (binary: **1 = At Risk**, **0 = No Risk**)

* Predictors: the modeling dataset includes 24 features across demographics, clinical/physiologic measures, medical history, and lifestyle—with Patient ID excluded from the final set

### Data Dictionary

```{=html}
<table class="feature-table">
  <thead>
    <tr>
      <th>Feature</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>Patient ID</code></td><td>QL(Unique)</td><td>Unique identifier for each patient</td></tr>
    <tr><td><code>Age</code></td><td>Q(Int)</td><td>Age in years</td></tr>
    <tr><td><code>Sex</code></td><td>QL(2)</td><td>Male or Female</td></tr>
    <tr><td><code>Cholesterol</code></td><td>Q(Int)</td><td>Total cholesterol (mg/dL)</td></tr>
    <tr><td><code>Blood Pressure</code></td><td>QL(2)</td><td>Systolic / Diastolic (mmHg)</td></tr>
    <tr><td><code>Heart Rate</code></td><td>Q(Int)</td><td>Resting heart rate (bpm)</td></tr>
    <tr><td><code>Diabetes</code></td><td>QL(Bin)</td><td>Diabetes status (Yes/No)</td></tr>
    <tr><td><code>Family History</code></td><td>QL(Bin)</td><td>Family history of heart problems (1 Yes / 0 No)</td></tr>
    <tr><td><code>Smoking</code></td><td>QL(Bin)</td><td>Smoking status (1 Smoker / 0 Non-smoker)</td></tr>
    <tr><td><code>Obesity</code></td><td>QL(Bin)</td><td>Obesity status (1 Obese / 0 Not obese)</td></tr>
    <tr><td><code>Alcohol Consumption</code></td><td>QL(4)</td><td>None / Light / Moderate / Heavy</td></tr>
    <tr><td><code>Exercise Hours Per Week</code></td><td>Q(Real)</td><td>Hours of exercise per week</td></tr>
    <tr><td><code>Diet</code></td><td>QL(3)</td><td>Diet quality (Healthy / Average / Unhealthy)</td></tr>
    <tr><td><code>Previous Heart Problems</code></td><td>QL(Bin)</td><td>Prior heart-related issues (1 Yes / 0 No)</td></tr>
    <tr><td><code>Medication Use</code></td><td>QL(Bin)</td><td>Takes medication (1 Yes / 0 No)</td></tr>
    <tr><td><code>Stress Level</code></td><td>Q(Int)</td><td>Self-reported stress (1–10)</td></tr>
    <tr><td><code>Sedentary Hours Per Day</code></td><td>Q(Real)</td><td>Average sedentary hours per day</td></tr>
    <tr><td><code>Income</code></td><td>Q(Real)</td><td>Income level</td></tr>
    <tr><td><code>BMI</code></td><td>Q(Real)</td><td>Body Mass Index</td></tr>
    <tr><td><code>Triglycerides</code></td><td>Q(Int)</td><td>Triglycerides (mg/dL)</td></tr>
    <tr><td><code>Physical Activity Days Per Week</code></td><td>Q(Int)</td><td>Days with physical activity (per week)</td></tr>
    <tr><td><code>Sleep Hours Per Day</code></td><td>Q(Real)</td><td>Average sleep hours per day</td></tr>
    <tr><td><code>Country</code></td><td>QL(N)</td><td>Country of residence</td></tr>
    <tr><td><code>Continent</code></td><td>QL(7)</td><td>Continent of residence</td></tr>
    <tr><td><code>Hemisphere</code></td><td>QL(2)</td><td>Northern / Southern</td></tr>
    <tr><td><code>Heart Attack Risk</code></td><td>QL(Bin)</td><td>Target label (1 Yes / 0 No)</td></tr>
  </tbody>
</table>
::: {.callout-note}
**Notation used**

Q(Int) = Quantitative (Integer)  
Q(Real) = Quantitative (Real)  
QL(Bin) = Qualitative (Binary)  
QL(N) = Qualitative (Categorical) with N levels
:::

### Data Preprocessing

1. **Columns**
   * Drop `Patient.ID`
   * Move `Heart.Attack.Risk` to the first column

2. **Missing values and outliers**
   * Checked with a **z-score** screen  
   * **None detected** (no imputation or trimming applied)

3. **Blood pressure parsing**
   * Split `Blood.Pressure` into **`Systolic`** and **`Diastolic`**  
   * Example: `158/88` → `Systolic = 158`, `Diastolic = 88`

4. **Encode categorical variables**
   * **Binary to 0/1**
     * `Sex` → `Female` (1 = Female, 0 = Male)
     * `Hemisphere` → `Northern.Hemisphere` (1 = Northern, 0 = Southern)
     * Others were kept in numeric form when building a correlation matrix before being converted to factors for training models
   * **Multi-category (one-hot dummies)**
     * Created dummies for `Diet`, `Country`, `Continent`
     * Converted to numeric first when building a correlation matrix 
     * Converted to factors and finally dummies for training models

5. **Scale numeric features**
   * Standardize all numeric predictors to **mean = 0** and **standard deviation = 1**


### Dataset versions and splits

**Two final clean datasets (same row split, different handling of multi-category variables)**  

* **data**: 26 columns, multi-category variables kept as **factors**  
* **data1**: 52 columns, multi-category variables **dummy-encoded**

```{=html}
<table class="feature-table">
  <thead>
    <tr>
      <th>Dataset</th>
      <th>Columns</th>
      <th>Total rows</th>
      <th>Train rows</th>
      <th>Test rows</th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>data</code></td><td>26</td><td>8,763</td><td>3,138</td><td>4,382</td></tr>
    <tr><td><code>data1</code></td><td>52</td><td>8,763</td><td>3,138</td><td>4,382</td></tr>
  </tbody>
</table>

**Which dataset for which models**

* Numeric-only algorithms: use data1 (dummy-encoded) — e.g., k-NN, SVM
* Models that accept factors in our toolchain: use data (factor-based) — e.g., Logistic Regression, Naive Bayes, Decision Tree, Random Forest
(Using factors also yields clearer tree visualizations.)

**Class distribution strategy**

* Original distribution: ~36% “At risk”, ~64% “No risk”
* Test set (stratified): kept the original distribution (~36/64) to reflect real world prevalence
* Training set (balanced): adjusted to 50% / 50% (“At risk” / “No risk”) to reduce class-imbalance bias during learning

**Notes**

* Both datasets share the same train/test split, ensuring fair model comparisons.
* “Balanced” training was achieved by resampling so each class contributes equally.




# Exploratory Data Analysis

### Descriptive Analysis

#### Heart Attack Risk by Country

::: {.columns}
::: {.column width="60%"}

This chart shows the proportion of people labeled **At Risk** vs **No Risk** for heart attack in each country.  
The overall pattern is very similar across countries: most countries have an at-risk share of roughly one third.  
This suggests that risk is widespread and not driven by a single country in the dataset.
:::

::: {.column width="40%"}
![](p_images/heart1.jpg){fig-alt="Stacked proportion bar chart of heart attack risk by country" width=100%}
:::
:::

---

#### Distribution of At-Risk Patients by Age

::: {.columns}
::: {.column width="60%"} 

This plot shows how many **At Risk** cases appear at different ages.  
Risk is not just concentrated in older adults — there are many at-risk individuals starting in their mid 20s and continuing through the 60s, 70s, and 80s.  
That means elevated risk appears across the full adult age range.
:::

::: {.column width="40%"}
![](p_images/heart2.png){fig-alt="Histogram of at-risk heart attack cases by age with density line" width=100%}
:::
:::

---

#### Heart Attack Risk by Gender

::: {.columns}
::: {.column width="60%"}
The share of people labeled **At Risk** is very similar between males and females.  
In this dataset, baseline heart attack risk looks fairly balanced across gender, with no large gap in proportions.
:::

::: {.column width="40%"}
![](p_images/heart4.png){fig-alt="Stacked bar chart of heart attack risk proportion by gender" width=100%}
:::
:::


### Correlation Analysis

#### Correlation with Demographics
::: {.columns}
::: {.column width="60%"}
This correlation matrix looks at how **Heart.Attack.Risk** relates to demographic features such as **Sex**, **Age**, **Income**, **Country**, **Continent**, and **Hemisphere**.  

All the correlation values with Heart.Attack.Risk are very close to zero, which means there is **no strong linear relationship** between risk and any single demographic or location variable in this dataset. This suggests that heart attack risk is not being driven by demographic alone, and likely depends more on clinical and lifestyle factors than on where someone lives.
:::

::: {.column width="40%"}
![](p_images/heart3.png){fig-alt="Correlation plot between heart attack risk and demographic/geographic variables" width=100%}
:::
:::

---

#### Correlation with Physiological and Clinical Variables
::: {.columns}
::: {.column width="60%"}
This correlation matrix shows how **Heart.Attack.Risk** relates to physiological and clinical measures such as **Cholesterol**, **Systolic** and **Diastolic** blood pressure, **Triglycerides**, **Heart.Rate**, and **BMI**.  

The strongest positive correlations appear between **Cholesterol** and risk, and between **Systolic blood pressure** and risk.  
This suggests that higher cholesterol levels and higher systolic pressure are more associated with being labeled "At Risk" in this dataset, while the other variables have weaker or near-zero relationships.
:::

::: {.column width="40%"}
![](p_images/heart5.png){fig-alt="Correlation plot between heart attack risk and physiological/clinical variables" width=100%}
:::
:::

---

#### Correlation with Medical History
::: {.columns}
::: {.column width="60%"}
This correlation matrix looks at how **Heart.Attack.Risk** relates to medical history factors such as **Diabetes**, **Family.History**, **Previous.Heart.Problems**, **Medication.Use**, and **Stress.Level**.  

The strongest positive correlation with being "At Risk" is **Diabetes**, suggesting that a history of diabetes is an important signal for elevated heart attack risk in this dataset.  
Other history variables show weaker or near-zero direct correlations.
:::

::: {.column width="40%"}
![](p_images/heart6.png){fig-alt="Correlation plot between heart attack risk and medical history variables" width=100%}
:::
:::

---

#### Correlation with Lifestyle Factors
::: {.columns}
::: {.column width="60%"}
This correlation matrix shows how **Heart.Attack.Risk** relates to lifestyle factors such as **Smoking**, **Alcohol.Consumption**, **Diet**, **Exercise.Hours.Per.Week**, **Physical.Activity.Days.Per.Week**, **Sedentary.Hours.Per.Day**, and **Sleep.Hours.Per.Day**.  

The strongest relationship we see is a **negative correlation** between **Sleep.Hours.Per.Day** and heart attack risk, suggesting that fewer hours of sleep per day is associated with higher risk.  
Other lifestyle variables, including smoking and alcohol use, have weaker direct correlations in this dataset.
:::

::: {.column width="40%"}
![](p_images/heart7.png){fig-alt="Correlation plot between heart attack risk and lifestyle variables" width=100%}
:::
:::


# Tools
Modeling and data: **R**
<br>
Visualization and reporting: **Tableau**
<br>